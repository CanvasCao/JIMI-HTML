(function(n,t,b,u){function h(c,f,d){this.C=this.container="string"==typeof c?b(c):c;this.data=f;this.ifBtn=d;this.config={};this.init()}h.prototype={init:function(){this.initConfig();this.createDom();this.initCSS();this.bindEvent()},initConfig:function(){Array.prototype.difference=function(b){for(var f=[],d=0;d<this.length;d++){for(var e=!0,g=0;g<b.length;g++)this[d]==b[g]&&(e=!1);e&&f.push(this[d])}return f}},createDom:function(){var c=this;b(this.C).append("<div class='canvasBox'></div><div class='nonCanvas'><div style='height: 20px ;border-top: 1px solid #bdbdbd;'></div><div class='barCon'><div class='barSafe'></div><div class='barSense'></div></div><div class='number'></div><div class='formulaCon'><div class='formulaTxtSec'><span class='formulaPoint' style='background-color:#d2d2d2'></span><span class='formulaTxt' style='color:#d2d2d2'>\u6b63\u5e38\u6210\u5206</span></div><div class='formulaTxtSec'><span class='formulaPoint' style='background-color:#e5004f'></span><span class='formulaTxt' style='color:#e5004f'>\u614e\u7528\u6210\u5206</span></div></div></div>");
    b(this.C).find(".formulaTxtSec").append("<a></a>");b(this.C).find(".formulaTxtSec a").each(function(f,d){var e=base64_encode('{ "type": 4, "objId": "'+c.data.objId+'","altBtnIndex":'+f+"}");b(this).attr({href:"jimi://"+e})})},initCSS:function(){b(this.C).find(".canvasBox").css({});b(this.C).find(".nonCanvas").css({display:"none","padding-bottom":"40px"});b(this.C).find(".barCon").css({height:"24px"});b(this.C).find(".barSafe").css({backgroundColor:"#d2d2d2",float:"left",height:"12px"});b(this.C).find(".barSense").css({"background-color":"#d13052",
    float:"right",height:"12px"});b(this.C).find(".number").css({margin:"10px 0",color:"#d2d2d2"});b(this.C).find(".formulaCon").css({display:"inline-block",float:"right"});b(this.C).find(".formulaTxtSec").css({display:"inline-block","margin-left":"20px",position:"relative"}).find("a").css({position:"absolute",width:"100%",height:"100%",left:0,top:0});b(this.C).find(".formulaPoint").css({float:"left",width:"10px",height:"10px","border-radius":"3px","margin-right":"5px","margin-top":"4px"})},bindEvent:function(){var c=
    this.data;$canvas=b(this.C).find(".canvasBox");$canvas.css({height:300,overflow:"hidden"});var f=$canvas[0],d=echarts.init(f);if(c.component){var e={title:{top:"bottom",right:10},tooltip:{formatter:"{b}",triggerOn:"click",position:[10,10]},legend:[{data:["\u529f\u6548\u578b","\u5242\u578b\u9700\u6c42","\u4fdd\u6e7f\u578b","\u9632\u6652\u578b"],orient:"vertical",align:"right",top:10,right:10}],animation:!0,series:[{name:"\u6210\u5206\u8be6\u60c5",type:"graph",layout:"force",data:[],links:[],categories:[{name:"\u529f\u6548\u578b"},
    {name:"\u5242\u578b\u9700\u6c42"},{name:"\u4fdd\u6e7f\u578b"},{name:"\u9632\u6652\u578b"}],roam:"false",label:{normal:{position:"right",formatter:""}},force:{edgeLength:20,gravity:.1,repulsion:180},lineStyle:{normal:{}},color:["#fba41a","#d2d2d2","#3982e1","#23ad39"]}]},g=[];for(i=0;i<c.component.length;i++)g.push(c.component[i].name);var l=c.type[2].arr,p=c.type[1].arr.difference(l),h=c.type[0].arr.difference(l).difference(p),k=c.safe[0].arr;(function(){var b=[h,g.difference(h).difference(p).difference(l),
    p,l],c=["\u529f\u6548\u578b","\u5242\u578b\u9700\u6c42","\u4fdd\u6e7f\u578b","\u9632\u6652\u578b"];for(i=0;i<b.length;i++){for(a=0;a<b[i].length;a++)e.series[0].data.push({name:c[i]+" : "+b[i][a],value:8>=14-2*a?8:14-2*a,category:c[i],symbolSize:8>=14-2*a?8:14-2*a});for(a=1;a<=b[i].length;a++)e.series[0].links.push({source:c[i]+" : "+b[i][0],target:c[i]+" : "+b[i][a]})}for(i=0;i<c.length;i++)for(j=i;j<c.length;j++)e.series[0].links.push({source:c[i]+" : "+b[i][0],target:c[j]+" : "+b[j][0]});30<g.length&&
(e.series[0].force.gravity=.1+.01*(g.length-30));d.setOption(e)})();var c=g.length,k=k.length,n=c-k,m=k/c;1==m&&b(this.C).find(".barSafe").hide();0==m&&b(this.C).find(".barSense").hide();var r=1-m;b(this.C).find(".number").html("\u5171"+c+"\u79cd\u6210\u4efd");b(this.C).find(".barSense").css({width:100*m+"%"});b(this.C).find(".barSafe").css({width:100*r+"%"});b(this.C).find(".formulaTxt").eq(0).html("\u6b63\u5e38\u6210\u5206("+n+")");b(this.C).find(".formulaTxt").eq(1).html("\u614e\u7528\u6210\u5206("+
    k+")");b(this.C).find(".nonCanvas").show();var q=!1;b(this.C).find("canvas").click(function(){q||(d=echarts.init(f),d.setOption(e),q=!0)})}else c="",this.ifBtn&&(c='<a class="btn" href="http://n1.jimi.la/apps_T1/html5/whatever.html">\u8865\u5168\u6210\u5206</a>'),b(this.C).html('<div class="Con"></div>'),b(this.C).find(".Con").css({padding:20,"text-align":"center"}).html('<img class="nodataImg" src="img/nodata.png" width="30"><div class="txt">\u6210\u5206\u6570\u636e\u8865\u5168\u4e2d...</div>'+c),
    b(this.C).find(".nodataImg").css({display:"block",margin:"0 auto"}),b(this.C).find(".txt").css({color:"#bcbcbc",margin:"20px auto"}),b(this.C).find(".btn").css({padding:"6px 15px",margin:"0 auto","border-radius":30,backgroundColor:"#018cff",color:"white",display:"inline-block"})}};n.ProductDetailCanvas=h})(window,document,jQuery);